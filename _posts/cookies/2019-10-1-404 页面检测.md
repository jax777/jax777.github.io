---
layout: post
title: 404 页面检测
categories: tips
tag: tips
---

# 需求
识别自定义 404 页面、其他访问错误被阻止的页面。 

## 去重逻辑

404 页面检测,同一页面访问多次（4次）。
404 页面检测初始样本 每个路径爆破前均需探测一次。
多次请求，仅4次请求相同部分做特征，4个页面 对比3次

## 样本实例

404 特征

页面全部小写，长度短 lenth < 500
可解析 json ;字符串存在 error errmsg err limit


同一title 取 5个 
- json 串
json value 部分
```
status 200
application/json; encoding=utf-8
{"errcode":40066,"errmsg":"invalid url hint: [PsYa50543hkb5!]"}
```

```
status 200
application/json; encoding=utf-8
{"errcode":40066,"errmsg":"invalid url hint: [Wu0pdA0543hkb5!]"}

{"ActionStatus":"FAIL","ErrorCode":60012,"ErrorInfo":"Rest Api need sdkappid"} https://opensdk.mobile.qq.com:443/admin/logs/error-log


{"ActionStatus":"FAIL","ErrorCode":60002,"ErrorInfo":"HTTP parse Error"} https://opensdk.mobile.qq.com:443/admi


{"errCode":-3,"msg":"非法的请求参数","msg_en":"Invalid request parameters","sn":"29577_1289442","szDeviceID":"","szRequestID":""}  https://gamer.qq.com:443/downloader/cache.cfg

{\n"error": {\n"code": -1,\n"message": "Access Denied. AppName(), IP(), CGI()"\n}\n\n}\n https://qqmail.weixin.qq.com:443/cbc
```

```
<h1 style="text-align:center;">Not allowed!</h1>
<h1 style="text-align:center;">Not allowed!</h1>
```

- html 
腾讯存在两次请求返回不一的情况，第一次返回404 寻人页面，第二次返回404
`The requested URL '/xxxxxx' was not found on this server.`
```html
<!doctype html>
<html>
<head>
  <meta charset="gbk">
  <meta name="description" content="你访问的页面找不回来了，但是我们可以一起寻找失踪宝贝" />
  <meta name="description" content="公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。" />
  <meta name="description" content="腾讯志愿者是腾讯公司内部员工为响应公司做“最受人尊敬的互联网企业”的号召，自发组织成立的腾讯志愿者协会。2012年成立腾讯志愿者技术分会，开展404公益计划，无障碍产品推动等，结合腾讯产品、技术平台，开展公益帮扶。" />
  <link rel="dns-prefetch" href="//game.gtimg.cn">
  <link rel="dns-prefetch" href="//ossweb-img.qq.com">
  <link rel="stylesheet" type="text/css" href="//ossweb-img.qq.com/images/js/404/style.css">
  <title>一起寻找失踪宝贝 - 腾讯游戏温馨提示</title>
  <!-- 设计：eastzhang | 重构：karinfeng | 创建：20141017 | 更新：20141017 | 团队博客：//tgideas.qq.com -->
</head>
<body>
<div class="baby_mod">
  <div class="hd">
    <div class="backcrumb">
      <a href="//game.qq.com/?ADTAG=IED.InnerCop.gameWeb.errPage" title="返回首页" class="link-game">返回首页<i class="icon-font">&#187</i></a>
    </div>
  </div>
  <div class="bd">
    <h1 class="title">您访问的页面找不回来了！<span class="title_find">但我们可以一起寻找失踪宝贝</span></h1>
    <div class="baby_data" id="baby_data"></div>
  </div>
  <div class="ft">
    <div class="logo_box">
      <div class="support_company"><a href="//e.t.qq.com/Tencent-Volunteers" alt="腾讯志愿者" title="腾讯志愿者">腾讯志愿者</a></div>
      <div class="baby_back"><a href="//bbs.baobeihuijia.com/" alt="宝贝回家" title="宝贝回家">宝贝回家</a></div>
    </div>
    <div class="bt_box">
      <div class="api404">公益404接入地址：<a href="//www.qq.com/404/" target="_blank">//www.qq.com/404/</a></div>
      <div class="api404">失踪儿童信息来自<a href="//bbs.baobeihuijia.com/" target="_blank">宝贝回家寻子网</a></div>
    </div>
    <div class="share_box">
      <!-- iShare BEGIN -->
      <div id="iShare" class="iShare iShareP1">
        <span class="Qs_txt">分享到：</span>
        <a class="Qs_weibo" title="腾讯微博">腾讯微博</a>
        <a class="Qs_qzone" title="QQ空间">QQ空间</a>
        <a class="Qs_sina" title="新浪微博">新浪微博</a>
        <a class="Qs_pengyou" title="朋友网">朋友网</a>
        <a class="Qs_qmail" title="QQ邮箱">QQ邮箱</a>
        <a class="Qs_kaixin" title="开心网">开心网</a>
        <a class="Qs_renren" title="人人网">人人网</a>
      </div>
      <!-- iShare END -->
    </div>
  </div>
</div>
<div class="guess-mod">
  <p class="guess-title">您可能喜欢：</p>
  <div class="guess-o2" id="guess_o2">

  </div>
</div>
<script charset="utf-8" src="//qzone.qq.com/gy/404/data.js"></script>
<script src="//ossweb-img.qq.com/images/js/404/main.js"></script>
<script src="//ac.o2.qq.com/php/show.php?loc_id=217_15e1433cfc52b7d9b7f23ddf47c09b52&func_type=1&v=1" charset="utf-8"></script>
<script src="//ossweb-img.qq.com/images/game/404/new/baobei_iShare.js"></script>
<script src="//ossweb-img.qq.com/images/js/foot.js"></script>
<script src="//ossweb-img.qq.com/images/js/title.js"></script>
<script src="//pingjs.qq.com/ping_tcss_ied.js"></script>
<script>
  // 分享
  (function(){shareQQ({WB:false});})();
  // 统计代码
  if (typeof (pgvMain) == 'function') pgvMain();
</script>
</body>
</html><!--[if !IE]>|xGv00|5ac791f0ff8576dc647739e2fe0d6fdb<![endif]-->
```


